<div class="controls-heading">
    <h2>Controls</h2>
</div>
<hr />
<div class="controls-input">
    <div class="controls-section">
        <h3 class="controls-section-heading"> Base controls </h3>

        <div class="controls-group">
            <div class="controls-label">Width</div>
            <input type="number" class="controls-number-input" ng-model="data.width" ng-change="changeValue('width')" /> in.
            <input type="range" class="controls-slide-input" ng-model="data.width" ng-change="changeValue('width')" />
        </div>
        <div class="controls-group">
            <div class="controls-label">Length</div>
            <input type="number" class="controls-number-input" ng-model="data.length" ng-change="changeValue('length')" /> in.
            <input type="range" class="controls-slide-input" ng-model="data.length" ng-change="changeValue('length')" />
        </div>
        <div class="controls-group">
            <div class="controls-label">Height</div>
            <input type="number" class="controls-number-input" ng-model="data.height" ng-change="changeValue('height')" /> in.
            <input type="range" class="controls-slide-input" ng-model="data.height" ng-change="changeValue('height')" />
        </div>
    </div>

    <hr />

    <div class="controls-section">
        <h3 class="controls-section-heading"> Frames </h3>

        <div class="controls-group">
            <div class="controls-group">
                <div class="controls-label">Number of Frames</div>
                <input type="number" class="controls-number-input" ng-model="frameCount" ng-change="changeValue('frameCount')" />
                <input type="range" class="controls-slide-input" ng-model="frameCount" ng-change="changeValue('frameCount')" />
            </div>
            <h4>Distance from back</h4>
            <div ng-repeat="frame in data.frames">
                <div class="controls-group">
                    <div class="controls-label">frame</div>
                    <input type="number" class="controls-number-input" ng-model="frame" ng-change="changeValue('$index-distanceFromBack')" /> in.
                    <input type="range" class="controls-slide-input" ng-model="frame" ng-change="changeValue('$index-distanceFromBack')" />
                </div>
            </div>
        </div>
    </div>

    <hr />

    <div class="controls-section">
        <div class="controls-input">
            <div ng-repeat="(key, value) in data">
                <div ng-if="key != 'width' && key != 'height' && key != 'length'">
                    <div class="controls-label">
                        <i class="fa fa-angle-down carrot-icon" ng-click="openMenu(key)" id="{{key}}-menu-icon" /> {{key}}
                    </div>

                    <div class="controls-group" id="{{key}}-menu">
                        <table>
                            <thead>
                                <tr>
                                    <td>
                                        Position
                                    </td>
                                    <td>
                                        x
                                    </td>
                                    <td>
                                        y
                                    </td>
                                    <td>
                                        z
                                    </td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        Start
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.start[0]" ng-change="changeValue('{{key}}-start-x')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.start[1]" ng-change="changeValue('{{key}}-start-y')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.start[2]" ng-change="changeValue('{{key}}-start-z')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        Control
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.startControl[0]" ng-change="changeValue('{{key}}-startControl-x')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.startControl[1]" ng-change="changeValue('{{key}}-startControl-y')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.startControl[2]" ng-change="changeValue('{{key}}-startControl-z')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        End
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.end[0]" ng-change="changeValue('{{key}}-end-x')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.end[1]" ng-change="changeValue('{{key}}-end-y')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.end[2]" ng-change="changeValue('{{key}}-end-z')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        Control
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.endControl[0]" ng-change="changeValue('{{key}}-endControl-x')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.endControl[1]" ng-change="changeValue('{{key}}-endControl-y')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                    <td>
                                        <input type="number" class="controls-number-input" ng-model="value.endControl[2]" ng-change="changeValue('{{key}}-endControl-z')" onmousedown="mDown(event)" onmousemove="mMove(event)" onmouseup="mUp()"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
var mouseDown = false, oldMouseY, oldValue;

function mDown (e) {
  mouseDown = true;
  oldMouseY = e.clientY;
  oldValue = e.target.value;
}

function mMove (e) {
  if (mouseDown) {
    e.target.value = e.target.value - (oldMouseY - e.clientY) / 10;
  }
}

function mUp () {
  mouseDown = false;
}
</script>
